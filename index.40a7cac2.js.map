{"mappings":"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","sources":["src/js/news-page.js"],"sourcesContent":["const API_KEY = 'pJnhjsndYoXEeiZxcLsx3UMkwINk9PiQ';\nconst reqUrl = `https://api.nytimes.com/svc/mostpopular/v2/viewed/1.json?api-key=${API_KEY}`;\nconst ICON_HEART = '../images/sprite.svg#icon-heart';\nconst galleryRef = document.querySelector('.gallery__list');\nconst formRef = document.querySelector('.search-field');\nconst inputRef = document.querySelector('#search-field__input');\nconst paginationContainer = document.getElementById('pagination');\n\nformRef.addEventListener('submit', onSubmit);\ninputRef.addEventListener('input', createReq);\n\nconst emptyCard = '<li class=\"gallery__item\"></li>';\nlet totalItems = 0;\nlet srartIndex = 0;\nlet endIndex = 0;\nlet page = 1;\nlet totalPages = 0;\nlet itemsPerPage = 8;\nlet markData = {};\n\nasync function fetchNews(request) {\n  const response = await fetch(request);\n  if (!response.ok) {\n    throw new Error(responce.statusText);\n  }\n  return response.json();\n}\n\nfunction createMarkup(arr, page) {\n  srartIndex = (page - 1) * itemsPerPage;\n  endIndex = srartIndex + itemsPerPage;\n  initPagination(totalPages);\n\n  const markup = arr.map(el => {\n    return `<li class=\"gallery__item\">\n                    <p class=\"gallery__category\">Job searching</p>\n                    <img class=\"gallery__img\" src=\"${el.image}\" alt=\"${el.alt}\"/>\n                    <div class='gallery__favorite'><p>Add to favorite</p>\n                    <button type=\"button\"></button>\n                    <svg width='16' height='16'><use href=\"${ICON_HEART}\"></use>\n                    </svg></div>\n                    <h3 class=\"gallery__header\">${el.title}</h3>\n                    <p class=\"gallery__text\">${el.descr}</p>\n                    <div class=\"gallery__item-bottom_wrap\">\n                        <span class=\"gallery__date\">${el.date}</span>\n                        <a href=\"${el.source}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"gallery__link\">Read more</a>\n                    </div>\n                </li>`;\n  });\n  const pageMarkup = markup.slice(srartIndex, endIndex);\n  // console.log(pageMarkup);\n  pageMarkup.splice(2, 0, emptyCard);\n  const finishedMkp = pageMarkup.join('');\n  // console.log(finishedMkp);\n  // console.log(markup);\n  galleryRef.insertAdjacentHTML('beforeend', finishedMkp);\n}\n\nfunction normalizePop(feed) {\n  const marks = feed.map(el => {\n    function checkoutDescr() {\n      if (el.abstract.length > 120) {\n        return el.abstract.slice(0, 119) + '...';\n      }\n      return el.abstract;\n    }\n    const descr = checkoutDescr();\n    const dateFormat = new Date(el.published_date);\n    const date = new Intl.DateTimeFormat().format(dateFormat);\n    function ckeckoutTit() {\n      if (el.title.length > 50) {\n        return el.title.slice(0, 49) + '...';\n      }\n      return el.title;\n    }\n    const title = ckeckoutTit();\n    // console.log(title.length);\n    const source = el.url;\n    function checkoutImg() {\n      if (el.media.length === 0) {\n        return 'https://t3.ftcdn.net/jpg/04/62/93/66/360_F_462936689_BpEEcxfgMuYPfTaIAOC1tCDurmsno7Sp.jpg';\n      }\n      return el.media[0]['media-metadata'][2].url;\n    }\n    const image = checkoutImg();\n    function checkoutAlt() {\n      if (el.media.length === 0) {\n        return 'Image is no avalible';\n      }\n      return el.media[0].caption;\n    }\n    const alt = checkoutAlt();\n    // console.log(alt);\n    // console.log(image);\n\n    return { descr, date, title, source, image, alt };\n  });\n  // console.log(marks);\n  markData = marks;\n  // console.log(markData);\n  return markData;\n}\n\nfunction startFetch() {\n  fetchNews(reqUrl).then(res => {\n    // console.log(res.results);\n    totalItems = res.results.length;\n    totalPages = Math.ceil(totalItems / itemsPerPage);\n    normalizePop(res.results);\n    createMarkup(markData, page);\n  });\n}\nstartFetch();\n\nfunction clearMarkup() {\n  galleryRef.innerHTML = '';\n}\n\nfunction normalizeSrc(feed) {\n  const marks = feed.map(el => {\n    function checkoutDescr() {\n      if (el.abstract.length > 120) {\n        return el.abstract.slice(0, 119) + '...';\n      }\n      return el.abstract;\n    }\n    const descr = checkoutDescr();\n    const dateFormat = new Date(el.pub_date);\n    const date = new Intl.DateTimeFormat().format(dateFormat);\n    function ckeckoutTit() {\n      if (el.headline.main.length > 50) {\n        return el.headline.main.slice(0, 49) + '...';\n      }\n      return el.headline.main;\n    }\n    const title = ckeckoutTit();\n    const source = el.web_url;\n    const imagePart = el.multimedia;\n\n    function checkoutImg() {\n      if (imagePart.length === 0) {\n        return 'https://t3.ftcdn.net/jpg/04/62/93/66/360_F_462936689_BpEEcxfgMuYPfTaIAOC1tCDurmsno7Sp.jpg';\n      }\n      return `https://static01.nyt.com/${imagePart[0].url}`;\n    }\n    const image = checkoutImg();\n    const alt = 'New`s image';\n    // console.log(image);\n    return { descr, date, title, source, image, alt };\n  });\n  // console.log(marks);\n  markData = marks;\n  return markData;\n}\n\nfunction onSearch(inputData) {\n  const searchUrl = `https://api.nytimes.com/svc/search/v2/articlesearch.json?q=${inputData}&api-key=${API_KEY}`;\n  fetchNews(searchUrl).then(res => {\n    console.log(res.response.docs);\n    if (res.response.docs.length === 0) {\n      console.log('Empty');\n    }\n    normalizeSrc(res.response.docs);\n    createMarkup(markData, page);\n  });\n}\n\n// onSearch('ukraine');\n\nlet searchReq = '';\nfunction createReq(e) {\n  searchReq = e.target.value.trim();\n  // console.log(searchReq);\n}\nfunction onSubmit(e) {\n  e.preventDefault();\n  clearMarkup();\n  onSearch(searchReq);\n}\n\n// const encoded = encodeURIComponent('crosswords & games'); //crosswords%20&%20games\n\n// пагинация\nfunction initPagination(totalPages) {\n  const pagination = new tui.Pagination(paginationContainer, {\n    totalItems: totalPages,\n    itemsPerPage: 1,\n    visiblePages: 3,\n    centerAlign: true,\n    // firstItemClassName: 'tui-first-child',\n    // lastItemClassName: 'tui-last-child',\n    template: {\n      page: '<a href=\"#\" class=\"tui-page-btn\">{{page}}</a>',\n      currentPage:\n        '<strong class=\"tui-page-btn tui-is-selected\">{{page}}</strong>',\n      moveButton:\n        '<a href=\"#\" class=\"tui-page-btn tui-{{type}}\">' +\n        '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n        '</a>',\n      disabledMoveButton:\n        '<span class=\"tui-page-btn tui-is-disabled tui-{{type}}\">' +\n        '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n        '</span>',\n      moreButton:\n        '<a href=\"#\" class=\"tui-page-btn tui-{{type}}-is-ellip\">' +\n        '<span class=\"tui-ico-ellip\">...</span>' +\n        '</a>',\n    },\n  });\n\n  // pagination.disabledMoveButton('first');\n\n  pagination.on('beforeMove', event => {\n    const currentPage = event.page;\n    console.log(event);\n    clearMarkup();\n    createMarkup(markData, currentPage);\n  });\n}\n"],"names":["$79f308477d4df87e$var$galleryRef","document","querySelector","$79f308477d4df87e$var$formRef","$79f308477d4df87e$var$inputRef","$79f308477d4df87e$var$paginationContainer","getElementById","addEventListener","e","preventDefault","$79f308477d4df87e$var$clearMarkup","inputData","$79f308477d4df87e$var$searchReq","$79f308477d4df87e$var$fetchNews","then","res","console","log","response","docs","length","feed","marks","map","el","checkoutDescr","abstract","slice","descr","dateFormat","Date","pub_date","date","Intl","DateTimeFormat","format","ckeckoutTit","headline","main","title","source","web_url","imagePart","multimedia","checkoutImg","url","$79f308477d4df87e$var$markData","$79f308477d4df87e$var$normalizeSrc","$79f308477d4df87e$var$createMarkup","target","value","trim","$79f308477d4df87e$var$totalItems","$79f308477d4df87e$var$srartIndex","$79f308477d4df87e$var$endIndex","$79f308477d4df87e$var$totalPages","async","request","fetch","ok","Error","responce","statusText","json","arr","page1","totalPages1","tui","Pagination","totalItems","itemsPerPage","visiblePages","centerAlign","template","page","currentPage","moveButton","disabledMoveButton","moreButton","on","event","pageMarkup","image","alt","splice","finishedMkp","join","insertAdjacentHTML","innerHTML","results","Math","ceil","published_date","media","caption","$79f308477d4df87e$var$normalizePop"],"version":3,"file":"index.40a7cac2.js.map"}